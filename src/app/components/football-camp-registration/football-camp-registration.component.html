<div *ngIf="footballCamp && sessions" class="registration-main-container">
  <div class="registration-logo-container">
    <img [src]="footballCamp.details.pathToLogo" class="details-logo">
    <img src="./assets/img/soccer-sketch.png" class="soccer-ball">
    <hr class="vertical-line">
  </div>


  <!-- Stepper -->
  <div class="registration-stepper-container">
    <mat-vertical-stepper [linear]="isLinear" #stepper>
      <!--Etape : Choisir la session -->
      <mat-step [stepControl]="sessionForm">
        <form [formGroup]="sessionForm" class="session-form-group-container" novalidate>
          <ng-template matStepLabel>Session</ng-template>
          <mat-card class="session-card" *ngFor="let session of sessions; let i = index">
            <mat-icon class="icon-selected-session" color="primary" *ngIf="sessionForm.get('session').value == session">
              check
            </mat-icon>
            <mat-card-header>
              <mat-card-title>Session n°{{i}}</mat-card-title>
              <mat-card-subtitle>Du {{session.start | date : 'longDate'}} au {{session.end | date : 'longDate'}}
              </mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div *ngIf="session.halfBoardRates">Prix demi-pension : {{session.halfBoardRates}} € <br></div>
              <div *ngIf="session.fullBoardRates">Prix pension complète: {{session.fullBoardRates}} € <br></div>
              <div>Disponibilité : {{session.maximumNumberOfRegistrations - session.currentNumberOfRegistrations}}
                place(s) restante(s)
              </div>
            </mat-card-content>
            <mat-card-actions align="start">
              <button [disabled]="session.currentNumberOfRegistrations >= session.maximumNumberOfRegistrations"
                      mat-raised-button color="primary" (click)="onSessionSelected(session)">Choisir
              </button>
            </mat-card-actions>
          </mat-card>
          <mat-form-field class="hidden-input">
            <input matInput formControlName="session">
          </mat-form-field>
        </form>
      </mat-step>
      <!--Etape : Renseigner les informations -->
      <mat-step [stepControl]="registrationForm">
        <form [formGroup]="registrationForm" #registrationFormRef="ngForm" class="registration-form-group-container"
              novalidate>
          <ng-template matStepLabel>Inscription</ng-template>
          <h4>Informations générales</h4>
          <!-- Photo -->
          <img src="./assets/img/registration/avatar2.png" class="registration-avatar">

          <!-- Nom & Prénom -->
          <mat-form-field>
            <input matInput placeholder="Prénom" formControlName="firstname" required>
            <mat-error *ngIf="registrationForm.get('firstname').invalid">{{getFirstnameError()}}</mat-error>
          </mat-form-field>

          <mat-form-field>
            <input matInput placeholder="Nom" formControlName="lastname" required>
            <mat-error *ngIf="registrationForm.get('lastname').invalid">{{getLastnameError()}}</mat-error>
          </mat-form-field>

          <!-- Sexe -->
          <mat-radio-group formControlName="gender">
            <mat-radio-button value="MALE">Garçon</mat-radio-button>
            <mat-radio-button value="FEMALE">Fille</mat-radio-button>
            <mat-error *ngIf="registrationForm.get('gender').invalid && registrationFormRef.submitted">
              {{getGenderError()}}
            </mat-error>
          </mat-radio-group>
          <span class="separator"></span>

          <!-- Date de naissance -->
          <mat-form-field>
            <input matInput [matDatepicker]="picker" placeholder="Date de naissance" formControlName="birthdate">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker disabled="false"></mat-datepicker>
          </mat-form-field>

          <!-- Email -->
          <mat-form-field>
            <input matInput type="email" placeholder="Email" formControlName="email" required>
            <mat-error *ngIf="registrationForm.get('email').invalid">{{getEmailError()}}</mat-error>
          </mat-form-field>

          <!-- Adresse -->
          <mat-form-field>
            <input matInput placeholder="Adresse" formControlName="address">
          </mat-form-field>

          <h4>Caractéristiques sportives</h4>
          <!-- Club -->
          <mat-form-field>
            <input matInput placeholder="Club actuel" formControlName="club">
          </mat-form-field>
          <!-- Poste préféré : Gardien / Défenseur / Milieu / Attaquant -->
          <mat-radio-group>
            <mat-radio-button value="1">Gardien</mat-radio-button>
            <mat-radio-button value="2">Défenseur</mat-radio-button>
            <mat-radio-button value="3">Milieu</mat-radio-button>
            <mat-radio-button value="4">Attaquant</mat-radio-button>
          </mat-radio-group>
          <span class="separator"></span>
          <!-- Pied Gauche / Droit -->
          <mat-radio-group>
            <mat-radio-button value="1">Droitier</mat-radio-button>
            <mat-radio-button value="2">Gaucher</mat-radio-button>
          </mat-radio-group>
          <span class="separator"></span>
          <div class="next-button">
            <button mat-button matStepperNext mat-raised-button color="primary">Suivant
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </form>
      </mat-step>
      <!--Etape : Payer -->
      <mat-step [stepControl]="paymentFormGroup">
        <form [formGroup]="paymentFormGroup" class="payment-form-group-container">
          <ng-template matStepLabel>Paiement</ng-template>
          <div>
            <b>La fonctionnalité de paiement en ligne n'est pas encore disponible.</b>
            <br>
            En cliquant sur suivant, votre pré-inscription sera active pour le stage de {{footballCamp.city}}.
            <br>
            Vous devrez verser la somme de <b>{{session.value.fullBoardRates}} €</b> pour confirmer
            votre inscription.
            <br>
            Pour confirmer votre inscription, veuillez contacter une des personnes suivantes:
            <br>
            <mat-list>
              <mat-list-item *ngFor="let organizer of footballCamp.details.organizers">
                <!-- TODO : CSS -->
                <img matListAvatar [src]="organizer.pathToPicture" class="contact-avatar"
                     *ngIf="organizer.manageRegistration">
                <h3 matLine *ngIf="organizer.manageRegistration"> {{organizer.firstname}} {{organizer.lastname}} </h3>
                <p matLine *ngIf="organizer.manageRegistration">
                  <span> {{organizer.phoneNumber}} </span>
                </p>
              </mat-list-item>
            </mat-list>
          </div>
          <span class="separator"></span>
          <div class="next-button">
            <button mat-button matStepperNext mat-raised-button color="primary" (click)="onNextPayment()">
              Suivant
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
          <mat-form-field class="hidden-input">
            <input matInput formControlName="payment">
          </mat-form-field>
        </form>
      </mat-step>
      <!--Etape : Récapitulatif -->
      <mat-step [editable]="false">
        <ng-template matStepLabel>Récapitulatif</ng-template>
        Félicitations vous êtes <b>pré-inscrit</b> pour le stage de {{footballCamp.city}} !
        <br>
        Vous avez du recevoir un mail de confirmation.
      </mat-step>
    </mat-vertical-stepper>
    <!--<span class="stepper-margin"></span>-->
  </div>
</div>
<div *ngIf="isLoading" class="loading-spinner-container">
  <mat-progress-spinner mode="indeterminate" color="primary"></mat-progress-spinner>
</div>
